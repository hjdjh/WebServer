[readme.txt](https://github.com/hjdjh/WebServer/files/7020943/readme.txt)
# WebServer
Http  WebServer Reactor Linux C++


      该项目是基于Reactor和线程池的多并发服务器，支持定时器、日志器、和http长链接。每个线程池线程都都有一个定时器、epoll循环、任务队列，
      主线程不断循环在accept函数，有新连接到来时 使用轮询的方式 放到一个线程池线程的任务队列。
 
1、任务队列

（1）任务队列是基于queue<std::functor>,通过bind函数传参；

（2）每一个epoll循环都会挂载一个关于任务队列的文件描述符，通过向该文件描述符写数据来唤醒任务队列。



2、定时器采用的是优先队列。

3、日志器

（1）采用双缓冲的技术，日志器的前端有两个缓冲区，后端线程有两个缓冲区，当定时条件满足或前端缓冲区写满时通过条件变量通知日志器后台线程，后端线程将自身缓冲区和前端缓冲区进行交换，从而减少临界区。

（2）日志器有两个类，一个是LogStream,重载了<<运算符，进行格式化输入，并将日志信息成行；另一个是AsyncLogging静态类，有（1）所说的前端缓冲区，多线程共享。写日志信息时先调用日志器的构造函数，之后调用LogStream <<方法，在日志器析构的时候会添加时间、行号、所在文件名到日志信息上，然后将日志信息写到AsyncLogging的缓冲区上。


4、运行与测试

（1）在WebServer/build目录下运行cmake .. ; make ;./Main -p 2880 

(2)测试方法有两种，一是服务器运行后再浏览器访问Http://127.0.0.1/WebPage/begin.html ;二是在运行WebServer/tests目录下的客户端，该客户端会建立多个http客户端连接多次访问服务器的多个文件，并与原文件进行对比，判断是否出现错误。
